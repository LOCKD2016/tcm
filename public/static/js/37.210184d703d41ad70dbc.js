webpackJsonp([37],{109:function(t,s,i){var a=i(11)(i(160),i(240),null,null);t.exports=a.exports},160:function(t,s,i){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=i(12);s.default={data:function(){return{doctor:[],hospitals:[],schedules:[],schedulingTime:{},hospitals_set:0,schedule_set:0,hospital_id:0,hospital_name:"",scheduleDate:"",scheduleTime:"",doctor_name:"",container_arr:[],no_available_time:0}},created:function(){this.id=this.$route.query.id,this.type=this.$route.query.type,this.scheduleDate=this.$route.query.date,this.hospital_id=this.$route.query.clinicId,this.getDetail()},methods:{canceldel:function(){$(".layer_pop").addClass("none")},dodel:function(){$(".layer_pop").addClass("none"),this.$router.push({path:"/my_fmld/my"})},getDetail:function(){this.$http.get(this.$store.state.apiUrl+"doctor/detail/"+this.id+"?include=cliniques").then(function(t){t.data.status?(this.doctor=t.data.data,this.doctor_name=t.data.data.name,this.hospitals=t.data.data.cliniques.data,this.hospital_id=t.data.data.cliniques.data[0].id,this.hospital_name=t.data.data.cliniques.data[0].name,this.hospital_id>0&&this.getSchedules()):$("#step1").removeClass("none"),this.status=t.data.status},function(t){i.i(a.b)(t.data.data.errors)})},getSchedules:function(){this.$http({url:this.$store.state.apiUrl+"schedule/lists/"+this.id+"/"+this.hospital_id,method:"GET"}).then(function(t){for(var s=t.data.data,i=[],a=0;a<s.length;a++)-1==this.container_arr.indexOf(s[a].date)&&(this.container_arr.push(s[a].date),i.push(s[a]));this.schedules=i,this.scheduleDate?this.getScheduleTime():(this.scheduleDate=t.data.data[0].date,this.scheduleDate&&this.getScheduleTime()),0==this.schedules.length&&(this.no_available_time=1)},function(t){i.i(a.b)(t.data.data.errors)})},getScheduleTime:function(){this.$http({url:this.$store.state.apiUrl+"schedule/detail/"+this.id+"/"+this.hospital_id+"/"+this.scheduleDate,method:"GET"}).then(function(t){this.schedulingTime=t.data.data.list},function(t){i.i(a.b)(t.data.data.errors)})},setClinic:function(t,s,i){this.hospitals_set=t,this.hospital_id=s,this.hospital_name=i,$(".hospital").addClass("none")},bg:function(t){if(t)return"background-image:url("+t+")"},tms:function(t,s){var i=new Date(t),a=["日","一","二","三","四","五","六"];return 0==s?"上午":1==s?"下午":2==s?"夜间":3==s&&"全天",i.getMonth()+1+"月"+i.getDate()+"日 周"+a[i.getDay()]},changeTime:function(t){this.schedule_set=$(t.currentTarget).attr("value"),this.scheduleDate=this.schedules[this.schedule_set].date,this.getScheduleTime(),$(".dateSet").addClass("none")},timeActive:function(t){$(".timeactive").eq(t).addClass("active"),$(".timeactive").eq(t).siblings().removeClass("active"),this.scheduleTime=$(".timeactive").eq(t).html(),console.log(this.scheduleTime)},hospital:function(){$(".hospital").removeClass("none")},backTo:function(){$(".hospital").addClass("none")},dateSet:function(){$("body").addClass("calenOpen"),$(".dateSet").removeClass("none")},backTo2:function(){$(".dateSet").addClass("none")},peopleSet:function(){$(".peopleSet").removeClass("none")},backTo3:function(){$(".peopleSet").addClass("none")},confirmOrder:function(){if(!this.hospital_id)return $api.pop("请选择就诊诊所"),!1;if(!this.id)return $api.pop("请选择就诊医生"),!1;if(!this.scheduleDate)return $api.pop("请选择就诊日期"),!1;if(!this.scheduleTime)return $api.pop("请选择就诊时间"),!1;var t=this,s={};s.doctor_id=parseInt(this.id),s.date=this.scheduleDate,s.time=this.scheduleTime,s.clinique_id=parseInt(this.hospital_id),this.$http.post(this.$store.state.apiUrl+"bespeak/clinic",s).then(function(s,i){if(s.data.status){if(!s.data.data.bespeak_id)return $api.pop("获取预约ID失败"),!1;this.$router.push({path:"/confirmOrder",query:{clinique_id:t.hospital_id,doctor_id:t.id,date:t.scheduleDate,time:t.scheduleTime,doctor:t.doctor_name,bespeak_id:s.data.data.bespeak_id,clinque:t.hospital_name}})}else $api.pop(s.data.msg)},function(t){i.i(a.b)(t.data.data.errors)})}}}},240:function(t,s){t.exports={render:function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"fixbody doctor_outline"},[t._m(0),i("div",{staticClass:"pop",attrs:{id:"patSet"}}),i("div",{staticClass:"calendar_bg"}),i("div",{attrs:{id:"wrap"}},[i("div",{staticClass:"doc_banner"},[t.doctor.photoSUrl?i("div",{staticClass:"avatar",style:t.bg(t.doctor.photoSUrl)}):i("div",{staticClass:"avatar",style:t.bg("/img/doctor_default.png")}),i("h1",[i("b",[t._v(t._s(t.doctor_name)+"医师")])]),i("p",[i("span",[t._v("患者推荐指数：")]),i("span",{staticClass:"stars",attrs:{show:t.doctor.level}},[i("i",{staticClass:"icon-nav1"}),i("i",{staticClass:"icon-nav1"}),i("i",{staticClass:"icon-nav1"}),i("i",{staticClass:"icon-nav1"}),i("i",{staticClass:"icon-nav1"})])]),t.doctor.sections?i("p",{staticClass:"tit"},[t._v(t._s(t.doctor.sections.data[0].name)),i("span",[t._v(t._s(t.doctor.title))])]):t._e()]),i("div",{attrs:{id:"step2"}},[i("ul",{staticClass:"list-group"},[i("li",{on:{click:function(s){t.hospital()}}},[i("span",[t._v("就诊医院")]),i("div",{staticClass:"val"},[t._v(t._s(t.hospital_name))]),i("i",{staticClass:"icon-arrow-right"})]),this.schedules.length>0?i("li",{on:{click:function(s){t.dateSet()}}},[i("span",[t._v("就诊日期")]),i("div",{staticClass:"val",domProps:{innerHTML:t._s(t.tms(t.scheduleDate))}}),i("i",{staticClass:"icon-arrow-right"})]):t._e(),this.schedules.length>0?i("li",{staticClass:"li_jz"},[i("span",{staticClass:"s"},[t._v("就诊时间")]),i("div",{staticClass:"jz_time"},[t._l(t.schedulingTime,function(s,a){return[i("span",{staticClass:"timeactive",on:{click:function(s){t.timeActive(a)}}},[t._v(t._s(s))])]})],2)]):1==this.no_available_time?i("li",{staticClass:"li_js"},[i("span",{staticClass:"s"},[t._v(" 抱歉，您预约的医生没有时间")])]):t._e()])]),t._m(1),this.schedules.length>0?i("div",{staticClass:"btn btn-fix",on:{click:function(s){t.confirmOrder()}}},[t._v("确定预约")]):t._e()]),i("div",{staticClass:"hospital none"},[i("header",[i("div",{staticClass:"left",on:{click:function(s){t.backTo()}}},[i("i",{staticClass:"icon-arrow-left"})]),i("div",{staticClass:"center"},[t._v("就诊医馆")])]),i("ul",{staticClass:"addrs"},t._l(t.hospitals,function(s,a){return i("li",{class:t.hospital_id==s.id?"active":"",on:{click:function(i){t.setClinic(a,s.id,s.name)}}},[i("h3",[t._v(t._s(s.name))]),i("p",[t._v(t._s(s.address))]),i("i",{staticClass:"icon-check-c"}),i("span",{staticClass:"addr_a"})])}))]),i("div",{staticClass:"dateSet none"},[i("header",[i("div",{staticClass:"left",on:{click:function(s){t.backTo2()}}},[i("i",{staticClass:"icon-arrow-left"})]),i("div",{staticClass:"center"},[t._v("就诊日期")])]),i("div",{staticClass:"top_nav"},[i("p",{staticClass:"tit"},[t._v("仅开放一月内的门诊预约")]),i("div",{staticClass:"box box_2"},[i("div",{staticClass:"pricesBox clearfix"},t._l(t.schedules,function(s,a){return i("div",{staticClass:"prices",class:{active:a==t.schedule_set},attrs:{value:a},domProps:{innerHTML:t._s(t.tms(s.date))},on:{click:function(s){t.changeTime(s)}}},[i("span"),i("i",{staticClass:"icon-check"})])}))])])]),i("div",{staticClass:"layer_pop none"},[i("div",{staticClass:"content"},[i("div",{staticClass:"txt"},[t._v("请先去完善信息！")]),i("div",{staticClass:"pop_btn clearfix"},[i("div",{staticClass:"p_btn l",on:{click:function(s){t.dodel()}}},[t._v("确定")]),i("div",{staticClass:"p_btn",on:{click:function(s){t.canceldel()}}},[t._v("取消")])])])])])},staticRenderFns:[function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("header",[i("div",{staticClass:"left",attrs:{onclick:"back()"}},[i("i",{staticClass:"icon-arrow-left"})]),i("div",{staticClass:"center"},[t._v("预约医生")])])},function(){var t=this,s=t.$createElement,i=t._self._c||s;return i("div",{staticClass:"none",attrs:{id:"step1"}},[i("div",{staticClass:"doc_main"},[i("div",{staticClass:"btn_toggle"},[i("span",[t._v("该医生近一月内在该医馆无门诊信息")])])])])}]}}});